default_install_hook_types:
  - pre-commit
  - pre-push

repos:
  - repo: https://github.com/zizmorcore/zizmor-pre-commit
    rev: v1.22.0
    hooks:
      - id: zizmor

  - repo: local
    hooks:
      - id: check-pom-consistency
        name: Check POM/dependabot consistency
        language: system
        entry: python3 .github/scripts/check-pom-consistency.py
        files: ^pom\.xml$|^\.github/dependabot\.yml$
        pass_filenames: false

      - id: unit-tests
        name: Unit tests
        language: system
        entry: ./mvnw
        args: [-B, -ntp, -P!integration-tests, test]
        files: ^src/|pom\.xml$
        pass_filenames: false

      - id: integration-tests
        name: Integration tests
        language: system
        entry: ./mvnw
        # -DskipTests skips surefire unit tests (already run at pre-commit stage)
        args: [-B, -ntp, -DskipTests, -Pintegration-tests, verify]
        files: ^src/|pom\.xml$
        pass_filenames: false
        stages: [pre-push]
